<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layoutHome}">
<head>
<meta charset="UTF-8">
<title>Passenger Join</title>
<!-- css js -->
<style>	
.errormsg { color: red; }
.emailButton { padding-top: 24px; }
.formButton { margin: 0 12px; }
</style>
</head>

<th:block layout:fragment="content">
	<div class="container mt-5">
		<div class="input-form-backgroud row">
			<div class="input-form col-md-12 mx-auto">
				<h4 class="mb-3">회원가입</h4>
				<form class="validation-form" novalidate action="" method="post" th:object="${passenger}">
					<div class="row">
						<div class="col-md-6 mb-3">
							<label for="userEmail">아이디</label>
							<input type="email" class="form-control" id="userEmail" name="userEmail" placeholder="이메일(carpooling@example.com)"
								pattern="[a-zA-Z0-9]+[@][a-zA-Z0-9]+[.]+[a-zA-Z]+[.]*[a-zA-Z]*"
								th:field="*{userEmail}" title="이메일 양식:carpooling@example.com" required>
							<div class="invalid-feedback"><span>이메일을 입력해주세요.</span><span>(이메일 양식:example@sample.com)</span></div>
						</div>
						<div class="col-md-3 mb-3 emailButton">
							<!-- email 인증하기 버튼 -->
							<button type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#staticBackdrop"
							 th:onclick="|location.href='@{/passenger/join/mail/send}'|">인증하기</button>

							<!-- email 인증 Modal -->
							<div class="modal fade" id="staticBackdrop"
								data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
								aria-labelledby="staticBackdropLabel" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title" id="staticBackdropLabel">Email 인증번호를 입력해주세요.</h5>
											<button type="button" class="btn-close button"
												data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body">
											<label for="vCode">인증번호</label>
											<input type="text" class="form-control" id="vCode"
											th:field="*{userVcode}" name="userName" placeholder="인증번호" required>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-bs-dismiss="modal">취소</button>
											<button type="button" class="btn btn-dark">확인</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-4 mb-3">
							<label for="userPw">비밀번호</label>
							<input type="password" class="form-control" id="userPw" name="userPw" placeholder="비밀번호"
								pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[.$@$!%*#?&])[A-Za-z\d$@$!%*#?&]{8,16}$"
								title="영문, 숫자, 특수문자 각 1개 이상 포함 최소 8자리에서 최대 16자리까지"
								th:field="*{userPw}" required>
							<div class="invalid-feedback"><span>비밀번호를 입력해주세요.</span>
							<span>(영문대/소문자, 숫자, 특수문자 각 1개 이상 포함,</span><span>최소 8자리에서 최대 16자리까지)</span></div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-4 mb-3">
							<label for="userName">이름</label>
							<input type="text" class="form-control" id="userName" name="userName"
							th:field="*{userName}" placeholder="이름" required>
							<div class="invalid-feedback">이름을 입력해주세요.</div>
						</div>
					</div>
					
					<div class="row">
						<div class="col-md-4 mb-3">
							<label for="idNum1">주민등록번호(앞자리)</label>
							<input type="text" class="form-control" id="idNum1" name="idNum1" placeholder="앞 6자리"
							pattern="\d{6}" title="주민등록번호 앞자리 숫자 6개 입력" th:field="*{idNum1}" required>
							<div class="invalid-feedback">주민등록번호 앞 6자리를 입력해주세요.</div>
						</div>
						<div class="col-md-4 mb-3">
							<label for="idNum2">(뒷자리)</label>
							<input type="password" class="form-control" id="idNum2" name="idNum2" placeholder="뒤 7자리"
							pattern="[1-4]\d{6}" title="주민등록번호 뒷자리 숫자 7개 입력" th:field="*{idNum2}" required>
							<div class="invalid-feedback">주민등록번호 뒤 7자리를 입력해주세요.</div>
						</div>
					</div>
					<div class="custom-control custom-checkbox mb-3">
						<input type="checkbox" class="custom-control-input" id="aggrement"
							required> <label class="custom-control-label"
							for="aggrement">개인정보 수집 및 이용에 동의합니다.</label>
					</div>
					<div class="row">
						<div class="col-md-4 mb-3">
							<button type="submit" class="btn btn-dark formButton">가입완료</button>
							<button type="button" class="btn btn-light formButton" th:onclick="|location.href='@{/}'|">취소</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

<script>/* modal 사용 */
	var myModal = document.getElementById('myModal')
	var myInput = document.getElementById('myInput')
	
	myModal.addEventListener('shown.bs.modal', function () { myInput.focus() })
</script>
<script>/* bootstrap 유효성 검사 */
	window.addEventListener('load', () => {
	    const forms = document.getElementsByClassName('validation-form');
	
	    Array.prototype.filter.call(forms, (form) => {
		    form.addEventListener('submit', function (event) {
		    	if (form.checkValidity() === false) {
		        	event.preventDefault();
		            event.stopPropagation();
		        }
		        form.classList.add('was-validated');
		    }, false);
	    });
    }, false);
</script>
</th:block>

</html>