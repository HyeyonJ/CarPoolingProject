<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">        
<mapper namespace="project.carPooling.passenger.mapper.PassengerInfoMapper">

	<!-- public Integer insert(PassengerInfo passsenger); -->
	<insert id="insert" parameterType="PassengerInfo">
		<selectKey keyProperty="pUserGender" resultType="String" order="BEFORE">
			SELECT (CASE WHEN SUBSTR(#{pIdNum}, 7, 1) IN ('1', '3') THEN 'M'
				 ELSE 'F'
				 END) as pUserGender
			FROM dual
		</selectKey>
		INSERT INTO passenger (p_idx, p_user_type, p_user_id, p_user_pw, p_user_name, p_user_tel,
		p_user_email, p_user_gender, p_id_num, p_sign_out)
		VALUES(p_idx_seq.nextVal, #{pUserType}, #{pUserId}, #{pUserPw}, #{pUserName}, #{pUserTel},
		#{pUserEmail}, #{pUserGender}, #{pIdNum}, 'false')
	</insert>
	
	<!-- public PassengerInfo selectById(int id); -->
	
	<!-- public PassengerInfo selectByLoginId(String loginId); -->
	<select id="selectByLoginId" resultType="PassengerInfo">
		SELECT * FROM passenger
		WHERE p_user_id = #{pUserId}
	</select>
	
	<!-- public PassengerInfo selectByEmail(String email); -->
	<select id="selectByEmail" resultType="PassengerInfo">
		SELECT * FROM passenger
		WHERE p_user_email = #{pUserEmail}
	</select>
	
	<!-- public PassengerInfo selectByNameAndEmail(String name, String email); -->
	<select id="selectByNameAndEmail" resultType="PassengerInfo">
		SELECT * FROM passenger
		WHERE p_user_name = #{pUserName}
		AND p_user_email = #{pUserEmail}
	</select>

	<!-- public PassengerInfo selectByNameAndTel(String name, String tel); -->
	<select id="selectByNameAndTel" resultType="PassengerInfo">
		SELECT * FROM passenger
		WHERE p_user_name = #{pUserName}
		AND p_user_tel = #{pUserTel}
	</select>
	
	<!-- public PassengerInfo selectByNameAndIdnum(String name, String idnum1, String idnum2); -->
	<select id="selectByNameAndIdnum" resultType="PassengerInfo">
		SELECT * FROM passenger
		WHERE p_user_name = #{pUserName}
		AND p_id_num = #{p_idNum}
	</select>
	
	<!-- public List<PassengerInfo> selectAll(); -->
	
	<!-- public void deleteAll(); -->
	
	<!-- public PassengerInfo update(PassengerInfo passenger); -->
	
	
</mapper>